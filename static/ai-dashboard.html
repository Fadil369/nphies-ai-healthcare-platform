<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Performance Dashboard - BrainSAIT NPHIES</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f1419; color: #fff; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .metric-card { background: linear-gradient(135deg, #1e2a3a 0%, #2d3748 100%); padding: 20px; border-radius: 10px; border: 1px solid #4a5568; }
        .metric-value { font-size: 2.5rem; font-weight: bold; color: #4fd1c7; margin-bottom: 10px; }
        .metric-label { color: #a0aec0; font-size: 0.9rem; }
        .chart-container { background: #1a202c; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .status-indicator { width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-right: 8px; }
        .status-active { background: #48bb78; }
        .status-warning { background: #ed8936; }
        .status-error { background: #f56565; }
        .real-time-log { background: #1a202c; padding: 20px; border-radius: 10px; height: 300px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.8rem; }
        .log-entry { margin-bottom: 5px; padding: 5px; border-radius: 3px; }
        .log-info { background: rgba(72, 187, 120, 0.1); }
        .log-warning { background: rgba(237, 137, 54, 0.1); }
        .log-error { background: rgba(245, 101, 101, 0.1); }
        .btn { padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .btn:hover { background: #5a6fd8; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ AI Performance Dashboard</h1>
            <p>Real-time monitoring of NPHIES-AI system performance and analytics</p>
        </div>

        <div class="dashboard-grid">
            <div class="metric-card">
                <div class="metric-value" id="totalInteractions">0</div>
                <div class="metric-label">Total AI Interactions</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="accuracyRate">0%</div>
                <div class="metric-label">AI Accuracy Rate</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="responseTime">0ms</div>
                <div class="metric-label">Avg Response Time</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="uptime">0%</div>
                <div class="metric-label">System Uptime</div>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="metric-card">
                <h3>üè• Healthcare Contexts</h3>
                <div id="healthcareContexts"></div>
            </div>
            <div class="metric-card">
                <h3>üåê Language Support</h3>
                <div id="languageSupport"></div>
            </div>
            <div class="metric-card">
                <h3>üìä System Status</h3>
                <div id="systemStatus">
                    <div><span class="status-indicator status-active"></span>AI Engine: Active</div>
                    <div><span class="status-indicator status-active"></span>NPHIES Integration: Connected</div>
                    <div><span class="status-indicator status-active"></span>Real-time Streaming: Enabled</div>
                    <div><span class="status-indicator status-active"></span>WebSocket: Connected</div>
                </div>
            </div>
            <div class="metric-card">
                <h3>‚ö° Performance Metrics</h3>
                <div id="performanceMetrics">
                    <div>CPU Usage: <span id="cpuUsage">12%</span></div>
                    <div>Memory Usage: <span id="memoryUsage">45%</span></div>
                    <div>Active Connections: <span id="activeConnections">23</span></div>
                    <div>Queue Length: <span id="queueLength">0</span></div>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <h3>üìà Real-time Activity Monitor</h3>
            <div class="real-time-log" id="activityLog">
                <div class="log-entry log-info">[15:06:15] AI Assistant: Healthcare query processed successfully</div>
                <div class="log-entry log-info">[15:06:12] Claims Processing: New claim analyzed with 96% confidence</div>
                <div class="log-entry log-info">[15:06:08] NPHIES Integration: Eligibility check completed</div>
                <div class="log-entry log-info">[15:06:05] WebSocket: New client connected</div>
                <div class="log-entry log-info">[15:06:02] AI Engine: Model inference completed in 0.8s</div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button class="btn" onclick="refreshMetrics()">üîÑ Refresh Metrics</button>
            <button class="btn" onclick="exportData()">üìä Export Data</button>
            <button class="btn" onclick="clearLogs()">üóëÔ∏è Clear Logs</button>
        </div>
    </div>

    <script>
        let metricsInterval;
        let logInterval;

        async function loadMetrics() {
            try {
                const response = await fetch('/ai/analytics');
                const data = await response.json();
                
                document.getElementById('totalInteractions').textContent = data.total_interactions || 0;
                document.getElementById('accuracyRate').textContent = data.accuracy_rate || '0%';
                document.getElementById('responseTime').textContent = data.response_time_avg || '0ms';
                document.getElementById('uptime').textContent = data.uptime || '0%';
                
                // Healthcare contexts
                const contextsDiv = document.getElementById('healthcareContexts');
                if (data.healthcare_contexts) {
                    contextsDiv.innerHTML = data.healthcare_contexts.map(ctx => 
                        `<div>‚Ä¢ ${ctx.charAt(0).toUpperCase() + ctx.slice(1)}</div>`
                    ).join('');
                }
                
                // Language support
                const languagesDiv = document.getElementById('languageSupport');
                if (data.languages_supported) {
                    languagesDiv.innerHTML = data.languages_supported.map(lang => 
                        `<div>‚Ä¢ ${lang.toUpperCase()}</div>`
                    ).join('');
                }
                
            } catch (error) {
                console.error('Error loading metrics:', error);
            }
        }

        function addLogEntry(message, type = 'info') {
            const logContainer = document.getElementById('activityLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            
            logContainer.insertBefore(logEntry, logContainer.firstChild);
            
            // Keep only last 50 entries
            while (logContainer.children.length > 50) {
                logContainer.removeChild(logContainer.lastChild);
            }
        }

        function simulateRealTimeActivity() {
            const activities = [
                'AI Assistant: Processing healthcare query...',
                'Claims Engine: Analyzing new claim submission',
                'NPHIES: Validating provider credentials',
                'WebSocket: Client connection established',
                'AI Model: Inference completed successfully',
                'Cache: Updating healthcare knowledge base',
                'Security: Authentication verified',
                'Database: Query executed in 45ms',
                'Load Balancer: Health check passed',
                'Monitoring: System metrics updated'
            ];
            
            const randomActivity = activities[Math.floor(Math.random() * activities.length)];
            addLogEntry(randomActivity);
            
            // Update performance metrics
            document.getElementById('cpuUsage').textContent = (Math.random() * 20 + 10).toFixed(1) + '%';
            document.getElementById('memoryUsage').textContent = (Math.random() * 30 + 40).toFixed(1) + '%';
            document.getElementById('activeConnections').textContent = Math.floor(Math.random() * 50 + 20);
            document.getElementById('queueLength').textContent = Math.floor(Math.random() * 5);
        }

        function refreshMetrics() {
            loadMetrics();
            addLogEntry('Dashboard metrics refreshed', 'info');
        }

        function exportData() {
            addLogEntry('Exporting dashboard data...', 'info');
            alert('Data export functionality would be implemented here');
        }

        function clearLogs() {
            document.getElementById('activityLog').innerHTML = '';
            addLogEntry('Activity logs cleared', 'info');
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadMetrics();
            
            // Start real-time updates
            metricsInterval = setInterval(loadMetrics, 30000); // Every 30 seconds
            logInterval = setInterval(simulateRealTimeActivity, 3000); // Every 3 seconds
            
            addLogEntry('AI Performance Dashboard initialized', 'info');
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (metricsInterval) clearInterval(metricsInterval);
            if (logInterval) clearInterval(logInterval);
        });
    </script>
</body>
</html>
